<!DOCTYPE html>
<html>
<head>
	
	<title>COVID-19 Global Public Funding Map</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>

    <!-- Adding TableTop --> 
	<script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>

	<!-- //Adding FullScreen -->     
 	<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>
	<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet'/>

	<!-- Marker Cluster -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
	<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.js"></script>

	<!-- After Leaflet and Leaflet.markercluster scripts -->
	<script src="https://unpkg.com/leaflet.markercluster.layersupport@2.0.1/dist/leaflet.markercluster.layersupport.js"></script>




<style>

.info { 
	padding: 6px 8px; 
	font: 14px/16px Roboto, Helvetica, sans-serif; 
	background: white; 
	background: rgba(255,255,255,0.8); 
	box-shadow: 0 0 15px rgba(0,0,0,0.2); 
	border-radius: 5px; 
} 


.info h4 { 
	margin: 0 0 5px; 
	color: #262c33; 
}

.legend {
    line-height: 18px;
    color: #555;
}

.legend i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.7;
}

.marker-cluster-small {
background-color: rgba(104, 140, 186, 0.6) !important;
font: Roboto;
}
.marker-cluster-small div {
background-color: rgba(104, 140, 186, 0.6) !important;
font: Roboto;

}
.marker-cluster-medium {
background-color: rgba(207, 212, 110, 0.6) !important;
font: Roboto;
}
.marker-cluster-medium div {
background-color: rgba(207, 212, 110, 0.6) !important;
font: Roboto;
}
.marker-cluster-large {
background-color: rgba(212, 110, 110, 0.6) !important;
font: Roboto;
}
.marker-cluster-large div {
background-color: rgba(212, 110, 110, 0.6) !important;
font: Roboto;
}

</style>

	
</head>

<body>

	<div id="mapid" style="width: 100%; height: 720px;"></div>

<script>
	var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

	var grayscale   = L.tileLayer(mbUrl, {id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr})

	var vaccine = L.layerGroup();
	var diagnostic = L.layerGroup();
	var therapeutic = L.layerGroup();
	var pledges = L.layerGroup();


	var mymap = L.map('mapid', {
		center: [13.780815, 29.332267],
		zoom: 2,
		layers: [grayscale]
	});


    var cluster = L.markerClusterGroup.layerSupport();

	var info = L.control();

	info.onAdd = function (map) {
	    this._div = L.DomUtil.create('div', 'info');
	    this.update();
	    return this._div;
	};

	info.update = function (props) {
	    this._div.innerHTML = '<h4>Public Funding for COVID-19</h4>';
	};

	info.addTo(mymap);

	var legend = L.control({position: 'bottomright'});

	legend.onAdd = function (map) {

	    var div = L.DomUtil.create('div', 'info legend'),
	        labels = ['Vaccines', 'Diagnostics', 'Therapeutics', 'COVID Research Coalition', 'Open COVID Pledge'],
	        icon = ['vaccine.png', 'diagnostic.png', 'therapeutic.png', 'covidcoalition.png', 'opencovidpledge.png'];

	    // loop through our density intervals and generate a label with a colored square for each interval
	    for (var i = 0; i < labels.length; i++) {
	        div.innerHTML +=
	            '<img src="' + icon[i] + '" width="20" height="20" style="padding-right:12px;""> ' + labels[i] + '<br>';
	    }

	    return div;
	};

	legend.addTo(mymap);


	mymap.addControl(new L.Control.Fullscreen());


	Tabletop.init({
		key: 'https://docs.google.com/spreadsheets/d/11SrwemuqE5HsbipdmBNNukQsM4qBHjQSawNl6K94GHY/edit?usp=sharing',
		callback: addPoints,
		parseNumbers: true,
		simpleSheet: true
	});

	var overlays = {
		"Vaccines": vaccine,
		"Diagnostics": diagnostic,
		"Therapeutics": therapeutic,
		"COVID-19 Pledges": pledges
	};

	L.control.layers({}, overlays, {collapsed: false}).addTo(mymap);

	var vaccineIcon = L.icon({
		iconUrl: 'vaccine.png',
		iconSize: [27,27]
	});

	var diagnosticIcon = L.icon({
		iconUrl: 'diagnostic.png',
		iconSize: [32,32]
	});

	var therapeuticIcon = L.icon({
		iconUrl: 'therapeutic.png',
		iconSize: [27,27]
	});

	var covidcoalitionIcon = L.icon({
		iconUrl: 'covidcoalition.png',
		iconSize: [30,30]
	})

	var opencovidIcon = L.icon({
		iconUrl: 'opencovidpledge.png',
		iconSize: [25,25]
	})


	function addPoints(data, tabletop) {



		tabletop.sheets('US Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'NIH Funding (2003-2019) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2003-2019) (USD)"] + '</span>' + '<br>' + 'NIH Funding (2019-2020) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2019-2020) (USD)"] + '</span>' + '<br>' + 'Public Funding (Other) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding eg DOD etc"] + '</span>' + '<br>' + URL + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'NIH Funding (2003-2019) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2003-2019) (USD)"] + '</span>' + '<br>' + 'NIH Funding (2019-2020) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2019-2020) (USD)"] + '</span>' + '<br>' + 'Public Funding (Other) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding eg DOD etc"] + '</span>' + '<br>' + URL + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'NIH Funding (2003-2019) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2003-2019) (USD)"] + '</span>' + '<br>' + 'NIH Funding (2019-2020) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NIH funding (2019-2020) (USD)"] + '</span>' + '<br>' + 'Public Funding (Other) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding eg DOD etc"] + '</span>' + '<br>' + URL + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
					
		});


		tabletop.sheets('Canadian Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'CIHR Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of CIHR funding (CAD)"] + '</span>' + '<br>' + 'Genome Canada Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of Genome Canada funding (CAD)"] + '</span>' + '<br>' + 'Public Funding (Other) (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (NSERC, SSHRC, CRCC, IDRC, CATCO, etc.) (CAD)"] + '</span>' + '<br>' + URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'CIHR Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of CIHR funding (CAD)"] + '</span>' + '<br>' + 'Genome Canada Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of Genome Canada funding (CAD)"] + '</span>' + '<br>' + 'Public Funding (Other) (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (NSERC, SSHRC, CRCC, IDRC, CATCO, etc.) (CAD)"] + '</span>' + '<br>' + URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'CIHR Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of CIHR funding (CAD)"] + '</span>' + '<br>' + 'Genome Canada Funding (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of Genome Canada funding (CAD)"] + '</span>' + '<br>' + 'Public Funding (Other) (CAD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (NSERC, SSHRC, CRCC, IDRC, CATCO, etc.) (CAD)"] + '</span>' + '<br>' + URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}

		});

		
		tabletop.sheets('Aus & NZ Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of NHMRC (CREID) or MRFF funding (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NHMRC (CREID) or MRFF funding (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (APPRISE) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (APPRISE) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (CEPI) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (CEPI) (USD)"] + '</span>' + '<br>' + 'Amount of other public funding (Paul Ramsay Fdn) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (Paul Ramsay Fdn) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (HRC) (NZD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (HRC) (NZD)"] + '</span>' + '<br>' + 'Amount of other public funding (other) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (other) (AUD)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of NHMRC (CREID) or MRFF funding (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NHMRC (CREID) or MRFF funding (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (APPRISE) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (APPRISE) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (CEPI) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (CEPI) (USD)"] + '</span>' + '<br>' + 'Amount of other public funding (Paul Ramsay Fdn) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (Paul Ramsay Fdn) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (HRC) (NZD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (HRC) (NZD)"] + '</span>' + '<br>' + 'Amount of other public funding (other) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (other) (AUD)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of NHMRC (CREID) or MRFF funding (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of NHMRC (CREID) or MRFF funding (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (APPRISE) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (APPRISE) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (CEPI) (USD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (CEPI) (USD)"] + '</span>' + '<br>' + 'Amount of other public funding (Paul Ramsay Fdn) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (Paul Ramsay Fdn) (AUD)"] + '</span>' + '<br>' + 'Amount of other public funding (HRC) (NZD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (HRC) (NZD)"] + '</span>' + '<br>' + 'Amount of other public funding (other) (AUD): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of other public funding (other) (AUD)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}

		});


		tabletop.sheets('Korean Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of public funding (KRW): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of public funding (KRW)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					// oms.addMarker(marker);
					// cluster.addLayer(marker);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of public funding (KRW): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of public funding (KRW)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500})
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Amount of public funding (KRW): ' + '<span style="color:grey;font-weight:bold;">' + row["Amount of public funding (KRW)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Principal Investigators: ' + '<span style="color:grey;font-weight:bold;">' + row["Principle_Investigators"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});



		tabletop.sheets('Austria Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('Belgium Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('Denmark Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});

		// tabletop.sheets('EU Universities').elements.forEach(function (row) {

		// 	var URL = 'URLs: ';

		// 	if (row["Link_1"] != "") {
		// 		URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
		// 		if (row["Link_2"] != "") {
		// 			URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
		// 			if (row["Link_3"] != "") {
		// 				URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
		// 			}
		// 		}
		// 	}


		// 	switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

		// 		case "Vaccine":
		// 			var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
		// 				`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
		// 			marker.addTo(vaccine);
		// 			break;
		// 		case "Diagnostic":
		// 			var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
		// 				`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
		// 			marker.addTo(diagnostic);
		// 			break;
		// 		case "Therapeutic":
		// 			var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
		// 				`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
		// 			marker.addTo(therapeutic);
		// 			break;
		// 	}
		// });

		tabletop.sheets('France Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('Germany Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('NL Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "" && row["Link_2"] != undefined) {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "" && row["Link_3"] != undefined) {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Type of Recipient: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Recipient Institution"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Type of Recipient: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Recipient Institution"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Type of Recipient: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Recipient Institution"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('Sweden Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "") {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "") {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: diagnosticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: therapeuticIcon}).bindPopup(
						`<h3>` + row.University + `</h3>` + '<p style="text-align:left;">' + 'Type: ' + '<span style="color:grey;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Stage: ' + '<span style="color:grey;font-weight:bold;">' + row["Stage (Preclinical, Clinical)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:grey;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>'+ URL + '</a>' + '<br>' + 'Project Title: ' + '<span style="color:grey;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + '</p>', {maxwidth: 500});
					marker.addTo(therapeutic);
					break;
			}
		});


		tabletop.sheets('UK Universities').elements.forEach(function (row) {

			var URL = 'URLs: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
				if (row["Link_2"] != "" && row["Link_2"] != undefined) {
					URL = URL + ', <a href="' + row["Link_2"] + '" target="_blank">' + 'Link_2';
					if (row["Link_3"] != "" && row["Link_3"] != undefined) {
						URL = URL + ', <a href="' + row["Link_3"] + '" target="_blank">' + 'Link_3';
					}
				}
			}


			switch (row["Type of Research (Vaccine, Diagnostic, Therapeutic)"]) {

				case "Vaccine":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(vaccine);
					break;
				case "Diagnostic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(diagnostic);
					break;
				case "Therapeutic":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: vaccineIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'Type of Research: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Type of Research (Vaccine, Diagnostic, Therapeutic)"] + '</span>' + '<br>' + 'Total funding (€): ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Total funding (€)"] + '</span>' + '<br>' + 'Funding Mechanism: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Funding Mechanism"] + '</span>' + '<br>' + 'Project Title: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Project Title"] + '</span>' + '<br>' + 'Grant Period: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Grant Period"] + '</span>' + '<br>' + 'Research Stage: ' + '<span style="color:#353b8c;font-weight:bold;">' + row["Research Stage"] + '</span>' + '<br>'  + URL + '</span>' + '<br>' + '</p>', {maxwidth: 700});
					marker.addTo(therapeutic);
					break;
			}
		});

		tabletop.sheets('COVID Pledges').elements.forEach(function (row) {

			var URL = 'URL: ';

			if (row["Link_1"] != "") {
				URL = URL + '<a href="' + row["Link_1"] + '" target="_blank">' + 'Link_1';
			}


			switch (row["Pledge"]) {

				case "COVID-19 Clinical Research Coalition":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: covidcoalitionIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'The ' + '<span style="color:grey;font-weight:bold;">' + row["Pledge"] + '</span>' + ' includes a signatory from this University/Governmental-based Institution. ' + '<br>' + '<br>' + URL + '</p>', {maxwidth: 500}).addTo(mymap);
					marker.addTo(pledges);
					break;
				case "Open COVID Pledge":
					var marker = L.marker([row.Latitude, row.Longitude], {icon: opencovidIcon}).bindPopup(
						`<h3>` + row.Institution + `</h3>` + '<p style="text-align:left;">' + 'The ' + '<span style="color:grey;font-weight:bold;">' + row["Pledge"] + '</span>' + ' includes this University/Governmental-based Institution as a member. ' + '<br>' + '<br>' + URL + '</p>', {maxwidth: 500}).addTo(mymap);
					marker.addTo(pledges);
					break;
			}
		});

		cluster.addTo(mymap);
		cluster.checkIn(vaccine);
		cluster.checkIn(therapeutic);
		cluster.checkIn(diagnostic);
		cluster.checkIn(pledges);

		mymap.addLayer(vaccine);
		mymap.addLayer(diagnostic);
		mymap.addLayer(therapeutic);
		mymap.addLayer(pledges);






	}

</script>

</body>
</html>
